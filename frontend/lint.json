[{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\AudioLoadingScreen.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'status' is assigned a value but never used.","line":50,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":18},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\AudioLoadingScreen.tsx:53:30\n  51 |     const [errorMsg, setErrorMsg] = useState<string | null>(null);\n  52 |     const [showTimeout, setShowTimeout] = useState(false);\n> 53 |     const startTime = useRef(Date.now());\n     |                              ^^^^^^^^^^ Cannot call impure function\n  54 |     const pollRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  55 |\n  56 |     // Estimated time remaining","line":53,"column":30,"nodeType":null,"endLine":53,"endColumn":40},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\AudioLoadingScreen.tsx:57:22\n  55 |\n  56 |     // Estimated time remaining\n> 57 |     const elapsed = (Date.now() - startTime.current) / 1000;\n     |                      ^^^^^^^^^^ Cannot call impure function\n  58 |     const estimatedTotal = progress > 5 ? (elapsed / progress) * 100 : 0;\n  59 |     const remaining = Math.max(0, Math.ceil((estimatedTotal - elapsed) / 60));\n  60 |","line":57,"column":22,"nodeType":null,"endLine":57,"endColumn":32}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { AlertCircle, ArrowLeft, RotateCcw } from 'lucide-react';\r\n\r\ninterface AudioLoadingScreenProps {\r\n    paperTitle: string;\r\n    jobId: string;\r\n    onAudioReady: (audioUrl: string) => void;\r\n    onError: () => void;\r\n    onBack: () => void;\r\n}\r\n\r\nconst STATUS_PHASES = [\r\n    { min: 0, max: 20, text: 'Extracting paper content...' },\r\n    { min: 20, max: 40, text: \"Generating Alex's dialogue...\" },\r\n    { min: 40, max: 60, text: \"Generating Sam's dialogue...\" },\r\n    { min: 60, max: 80, text: 'Merging audio tracks...' },\r\n    { min: 80, max: 95, text: 'Finalizing your podcast...' },\r\n    { min: 95, max: 100, text: 'Almost ready...' },\r\n];\r\n\r\nfunction getStatusText(progress: number): string {\r\n    const phase = STATUS_PHASES.find(p => progress >= p.min && progress < p.max);\r\n    return phase?.text || STATUS_PHASES[STATUS_PHASES.length - 1].text;\r\n}\r\n\r\n// Animated word-by-word reveal component\r\nfunction AnimatedLine({ words, delay }: { words: string[]; delay: number }) {\r\n    return (\r\n        <span>\r\n            {words.map((word, i) => (\r\n                <motion.span\r\n                    key={i}\r\n                    initial={{ opacity: 0, y: 10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: delay + i * 0.15, duration: 0.4 }}\r\n                    className=\"inline-block mr-[0.3em]\"\r\n                >\r\n                    {word}\r\n                </motion.span>\r\n            ))}\r\n        </span>\r\n    );\r\n}\r\n\r\nexport function AudioLoadingScreen({ paperTitle, jobId, onAudioReady, onError, onBack }: AudioLoadingScreenProps) {\r\n    const navigate = useNavigate();\r\n    const [progress, setProgress] = useState(0);\r\n    const [status, setStatus] = useState('processing');\r\n    const [errorMsg, setErrorMsg] = useState<string | null>(null);\r\n    const [showTimeout, setShowTimeout] = useState(false);\r\n    const startTime = useRef(Date.now());\r\n    const pollRef = useRef<ReturnType<typeof setInterval> | null>(null);\r\n\r\n    // Estimated time remaining\r\n    const elapsed = (Date.now() - startTime.current) / 1000;\r\n    const estimatedTotal = progress > 5 ? (elapsed / progress) * 100 : 0;\r\n    const remaining = Math.max(0, Math.ceil((estimatedTotal - elapsed) / 60));\r\n\r\n    useEffect(() => {\r\n        // Poll for progress\r\n        pollRef.current = setInterval(async () => {\r\n            try {\r\n                const res = await fetch(`/api/audio/progress/${jobId}`);\r\n                if (!res.ok) {\r\n                    // Job might not be ready yet, keep polling\r\n                    return;\r\n                }\r\n                const data = await res.json();\r\n\r\n                setProgress(data.progress || 0);\r\n                setStatus(data.status);\r\n\r\n                if (data.status === 'complete' && data.url) {\r\n                    if (pollRef.current) clearInterval(pollRef.current);\r\n\r\n                    // Preload the audio file\r\n                    const audio = new Audio(data.url);\r\n                    audio.preload = 'auto';\r\n\r\n                    audio.addEventListener('canplaythrough', () => {\r\n                        onAudioReady(data.url);\r\n                    }, { once: true });\r\n\r\n                    audio.addEventListener('error', () => {\r\n                        // Even if preload fails, still navigate with the URL\r\n                        onAudioReady(data.url);\r\n                    }, { once: true });\r\n\r\n                    audio.load();\r\n                }\r\n\r\n                if (data.status === 'error') {\r\n                    if (pollRef.current) clearInterval(pollRef.current);\r\n                    setErrorMsg(data.error || 'Audio generation failed. Please try again.');\r\n                }\r\n            } catch {\r\n                // Network error, keep polling\r\n            }\r\n        }, 2000);\r\n\r\n        // 5-minute timeout\r\n        const timeout = setTimeout(() => setShowTimeout(true), 5 * 60 * 1000);\r\n\r\n        return () => {\r\n            if (pollRef.current) clearInterval(pollRef.current);\r\n            clearTimeout(timeout);\r\n        };\r\n    }, [jobId, onAudioReady]);\r\n\r\n    const handleContinueAnyway = () => {\r\n        if (pollRef.current) clearInterval(pollRef.current);\r\n        navigate('/listen');\r\n    };\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            <motion.div\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                exit={{ opacity: 0 }}\r\n                transition={{ duration: 0.5 }}\r\n                className=\"fixed inset-0 z-[100] flex flex-col items-center justify-center px-6\"\r\n                style={{ background: '#0A0A0F' }}\r\n            >\r\n                {/* Top Section — Logo & Paper Title */}\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: -20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.2 }}\r\n                    className=\"text-center mb-12\"\r\n                >\r\n                    <h2 className=\"text-xl font-display font-bold text-white mb-2\">\r\n                        <span className=\"text-brand-primary\">Paper</span>Cast\r\n                    </h2>\r\n                    <p className=\"text-brand-muted text-sm max-w-md mx-auto truncate\">{paperTitle}</p>\r\n                </motion.div>\r\n\r\n                {/* Center Section — Animated Quote */}\r\n                {!errorMsg && (\r\n                    <div className=\"text-center mb-16 relative\">\r\n                        {/* Violet glow background */}\r\n                        <div\r\n                            className=\"absolute inset-0 -m-20 rounded-full blur-[80px] opacity-20 pointer-events-none\"\r\n                            style={{ background: 'radial-gradient(circle, #6C63FF 0%, transparent 70%)' }}\r\n                        />\r\n\r\n                        <motion.div\r\n                            animate={{\r\n                                textShadow: [\r\n                                    '0 0 30px rgba(108,99,255,0.3)',\r\n                                    '0 0 50px rgba(108,99,255,0.5)',\r\n                                    '0 0 30px rgba(108,99,255,0.3)',\r\n                                ],\r\n                            }}\r\n                            transition={{ duration: 3, repeat: Infinity, ease: 'easeInOut' }}\r\n                            className=\"relative z-10\"\r\n                        >\r\n                            <p className=\"text-4xl sm:text-5xl font-display font-bold text-white leading-tight\">\r\n                                <AnimatedLine words={['Slow', 'is', 'Smooth,']} delay={0.3} />\r\n                            </p>\r\n                            <p className=\"text-4xl sm:text-5xl font-display font-bold text-white leading-tight mt-2\">\r\n                                <AnimatedLine words={['Smooth', 'is', 'Fast']} delay={1.0} />\r\n                            </p>\r\n                        </motion.div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Error State */}\r\n                {errorMsg && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, scale: 0.95 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        className=\"max-w-md w-full mb-12\"\r\n                    >\r\n                        <div className=\"bg-red-500/10 border border-red-500/30 rounded-2xl p-6 text-center space-y-4\">\r\n                            <AlertCircle className=\"w-10 h-10 text-red-400 mx-auto\" />\r\n                            <p className=\"text-red-400 font-medium\">Audio generation failed. Please try again.</p>\r\n                            <p className=\"text-brand-muted text-xs\">{errorMsg}</p>\r\n                            <div className=\"flex items-center justify-center gap-3 pt-2\">\r\n                                <button\r\n                                    onClick={onError}\r\n                                    className=\"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-brand-primary hover:bg-brand-primary-hover text-white text-sm font-semibold transition-all\"\r\n                                >\r\n                                    <RotateCcw className=\"w-4 h-4\" /> Try Again\r\n                                </button>\r\n                                <button\r\n                                    onClick={onBack}\r\n                                    className=\"flex items-center gap-2 px-5 py-2.5 rounded-xl border border-brand-border hover:border-brand-muted text-brand-muted hover:text-white text-sm font-medium transition-all\"\r\n                                >\r\n                                    <ArrowLeft className=\"w-4 h-4\" /> Back to Editor\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n\r\n                {/* Progress Section */}\r\n                {!errorMsg && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        transition={{ delay: 1.5 }}\r\n                        className=\"max-w-md w-full space-y-4\"\r\n                    >\r\n                        {/* Progress Bar */}\r\n                        <div className=\"w-full h-1 bg-[#1E1E2E] rounded-full overflow-hidden\">\r\n                            <motion.div\r\n                                className=\"h-full rounded-full\"\r\n                                style={{\r\n                                    background: 'linear-gradient(90deg, #6C63FF, #8b84ff)',\r\n                                }}\r\n                                initial={{ width: '0%' }}\r\n                                animate={{ width: `${progress}%` }}\r\n                                transition={{ duration: 0.8, ease: 'easeOut' }}\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Progress Text */}\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <p className=\"text-brand-muted text-xs font-mono\">\r\n                                {getStatusText(progress)}\r\n                            </p>\r\n                            <p className=\"text-brand-muted text-xs font-mono font-bold\">\r\n                                {progress}% complete\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Estimated Time */}\r\n                        <div className=\"text-center space-y-2 pt-4\">\r\n                            {remaining > 0 && progress > 5 && progress < 100 && (\r\n                                <p className=\"text-brand-muted text-xs\">\r\n                                    ~{remaining} {remaining === 1 ? 'minute' : 'minutes'} remaining\r\n                                </p>\r\n                            )}\r\n                            <p className=\"text-brand-muted/60 text-[11px]\">\r\n                                Your podcast will play automatically when ready\r\n                            </p>\r\n\r\n                            {/* Animated dots */}\r\n                            <div className=\"flex items-center justify-center gap-1.5 pt-2\">\r\n                                {[0, 1, 2].map(i => (\r\n                                    <motion.div\r\n                                        key={i}\r\n                                        className=\"w-1.5 h-1.5 rounded-full bg-brand-primary/60\"\r\n                                        animate={{ opacity: [0.3, 1, 0.3] }}\r\n                                        transition={{ duration: 1.2, repeat: Infinity, delay: i * 0.3 }}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Timeout Warning */}\r\n                        {showTimeout && (\r\n                            <motion.div\r\n                                initial={{ opacity: 0, y: 10 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                className=\"text-center pt-4 space-y-2\"\r\n                            >\r\n                                <p className=\"text-yellow-400 text-xs\">This is taking longer than expected...</p>\r\n                                <button\r\n                                    onClick={handleContinueAnyway}\r\n                                    className=\"text-brand-primary hover:underline text-xs font-medium\"\r\n                                >\r\n                                    Continue Anyway →\r\n                                </button>\r\n                            </motion.div>\r\n                        )}\r\n                    </motion.div>\r\n                )}\r\n            </motion.div>\r\n        </AnimatePresence>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\AudioPlayer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'audioRef'. Either include it or remove the dependency array.","line":32,"column":8,"nodeType":"ArrayExpression","endLine":32,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [audioRef, isPlaying]","fix":{"range":[1210,1221],"text":"[audioRef, isPlaying]"}}]},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\AudioPlayer.tsx:120:69\n  118 |               `}\n  119 |                             style={{\n> 120 |                                 height: `${isPlaying ? Math.max(10, Math.random() * 100) : 10}%`,\n      |                                                                     ^^^^^^^^^^^^^ Cannot call impure function\n  121 |                                 animationDelay: `${i * 0.05}s`,\n  122 |                                 opacity: isPlaying ? 0.6 + Math.random() * 0.4 : 0.3\n  123 |                             }}","line":120,"column":69,"nodeType":null,"endLine":120,"endColumn":82},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\AudioPlayer.tsx:122:60\n  120 |                                 height: `${isPlaying ? Math.max(10, Math.random() * 100) : 10}%`,\n  121 |                                 animationDelay: `${i * 0.05}s`,\n> 122 |                                 opacity: isPlaying ? 0.6 + Math.random() * 0.4 : 0.3\n      |                                                            ^^^^^^^^^^^^^ Cannot call impure function\n  123 |                             }}\n  124 |                         />\n  125 |                     ))}","line":122,"column":60,"nodeType":null,"endLine":122,"endColumn":73}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { Play, Pause, SkipBack, SkipForward, VolumeX, Volume2, Repeat } from 'lucide-react';\r\n\r\ninterface AudioPlayerProps {\r\n    audioUrl: string;\r\n    title: string;\r\n    duration?: string;\r\n    audioRef?: React.RefObject<HTMLAudioElement | null>;\r\n    onTimeUpdate?: (currentTime: number) => void;\r\n}\r\n\r\nexport function AudioPlayer({ audioUrl, title, duration = \"00:00\", audioRef: externalAudioRef, onTimeUpdate }: AudioPlayerProps) {\r\n    const internalRef = useRef<HTMLAudioElement | null>(null);\r\n    const audioRef = externalAudioRef ?? internalRef;\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [progress, setProgress] = useState(0);\r\n    const [volume, setVolume] = useState(1);\r\n    const [isMuted, setIsMuted] = useState(false);\r\n    const [playbackRate, setPlaybackRate] = useState(1);\r\n    const [isLooping, setIsLooping] = useState(false);\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        if (audioRef.current) {\r\n            if (isPlaying) {\r\n                audioRef.current.play().catch(e => console.error(\"Playback failed\", e));\r\n            } else {\r\n                audioRef.current.pause();\r\n            }\r\n        }\r\n    }, [isPlaying]);\r\n\r\n    const togglePlay = () => setIsPlaying(!isPlaying);\r\n\r\n    const handleTimeUpdate = () => {\r\n        if (audioRef.current) {\r\n            const current = audioRef.current.currentTime;\r\n            const total = audioRef.current.duration;\r\n            setProgress((current / total) * 100 || 0);\r\n            onTimeUpdate?.(current);\r\n        }\r\n    };\r\n\r\n    const handleAudioEnded = () => {\r\n        if (!isLooping) {\r\n            setIsPlaying(false);\r\n            setProgress(0);\r\n        }\r\n    };\r\n\r\n    const handleSeek = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const value = parseFloat(e.target.value);\r\n        setProgress(value);\r\n        if (audioRef.current && audioRef.current.duration) {\r\n            audioRef.current.currentTime = (value / 100) * audioRef.current.duration;\r\n        }\r\n    };\r\n\r\n    const skip = (seconds: number) => {\r\n        if (audioRef.current) {\r\n            audioRef.current.currentTime += seconds;\r\n        }\r\n    };\r\n\r\n    const handleVolumeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const value = parseFloat(e.target.value);\r\n        setVolume(value);\r\n        setIsMuted(value === 0);\r\n        if (audioRef.current) audioRef.current.volume = value;\r\n    };\r\n\r\n    const toggleMute = () => {\r\n        const newMutedState = !isMuted;\r\n        setIsMuted(newMutedState);\r\n        if (audioRef.current) {\r\n            audioRef.current.volume = newMutedState ? 0 : volume;\r\n        }\r\n    };\r\n\r\n    const changeSpeed = (speed: number) => {\r\n        setPlaybackRate(speed);\r\n        if (audioRef.current) audioRef.current.playbackRate = speed;\r\n    };\r\n\r\n    const formatTime = (seconds: number) => {\r\n        if (!seconds || isNaN(seconds)) return \"00:00\";\r\n        const m = Math.floor(seconds / 60);\r\n        const s = Math.floor(seconds % 60);\r\n        return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const currentTimeStr = audioRef.current ? formatTime(audioRef.current.currentTime) : \"00:00\";\r\n\r\n    return (\r\n        <div className=\"w-full bg-brand-card border border-brand-border rounded-2xl overflow-hidden shadow-2xl relative\">\r\n            <audio\r\n                ref={audioRef}\r\n                src={audioUrl}\r\n                onTimeUpdate={handleTimeUpdate}\r\n                onEnded={handleAudioEnded}\r\n                loop={isLooping}\r\n                className=\"hidden\"\r\n            />\r\n\r\n            {/* Abstract Waveform Viz Placeholder */}\r\n            <div className=\"h-48 w-full bg-brand-card flex items-center justify-center relative overflow-hidden group\">\r\n                <div className=\"absolute inset-0 bg-gradient-to-t from-brand-card to-transparent z-10\" />\r\n                <div className=\"absolute inset-0 opacity-20 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-brand-primary via-brand-bg to-brand-bg transition-opacity duration-1000\" />\r\n\r\n                {/* Animated bars */}\r\n                <div className=\"flex items-end justify-center gap-1 h-24 z-0 px-8 w-full\">\r\n                    {Array.from({ length: 40 }).map((_, i) => (\r\n                        <div\r\n                            key={i}\r\n                            className={`w-2 sm:w-3 rounded-t-sm bg-brand-primary transition-all duration-300 ease-in-out\r\n                ${isPlaying ? 'animate-pulse' : 'opacity-40'}\r\n              `}\r\n                            style={{\r\n                                height: `${isPlaying ? Math.max(10, Math.random() * 100) : 10}%`,\r\n                                animationDelay: `${i * 0.05}s`,\r\n                                opacity: isPlaying ? 0.6 + Math.random() * 0.4 : 0.3\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"absolute top-4 left-4 z-20 flex items-center gap-3\">\r\n                    <div className=\"w-12 h-12 rounded bg-gradient-to-br from-brand-primary to-brand-secondary opacity-80\" />\r\n                    <div>\r\n                        <div className=\"text-xs text-brand-muted font-mono mb-0.5\">PaperCast Series</div>\r\n                        <div className=\"text-sm font-medium text-white max-w-[200px] truncate\">{title}</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"absolute top-4 right-4 z-20 font-mono text-xs text-brand-muted bg-brand-bg/60 backdrop-blur-sm px-2 py-1 rounded\">\r\n                    {currentTimeStr} / {duration}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 relative z-20 bg-brand-card\">\r\n                {/* Progress Bar */}\r\n                <div className=\"mb-6 relative group cursor-pointer\">\r\n                    <input\r\n                        type=\"range\"\r\n                        min=\"0\"\r\n                        max=\"100\"\r\n                        value={progress}\r\n                        onChange={handleSeek}\r\n                        className=\"w-full absolute inset-0 opacity-0 cursor-pointer z-30\"\r\n                    />\r\n                    <div className=\"h-1.5 w-full bg-brand-bg rounded-full absolute inset-y-0 my-auto z-10 transition-all group-hover:h-2\">\r\n                        <div\r\n                            className=\"h-full bg-brand-primary shadow-[0_0_10px_rgba(108,99,255,0.8)] relative\"\r\n                            style={{ width: `${progress}%` }}\r\n                        >\r\n                            <div className=\"absolute right-0 top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full shadow translate-x-1/2\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Controls Row */}\r\n                <div className=\"flex flex-col sm:flex-row items-center justify-between gap-6\">\r\n\r\n                    {/* Speed Controls */}\r\n                    <div className=\"flex items-center gap-1.5 order-2 sm:order-1\">\r\n                        {[0.75, 1, 1.25, 1.5, 2].map(speed => (\r\n                            <button\r\n                                key={speed}\r\n                                onClick={() => changeSpeed(speed)}\r\n                                className={`text-[10px] font-mono px-2 py-1 rounded-full border transition-colors\r\n                  ${playbackRate === speed\r\n                                        ? 'border-brand-primary text-brand-primary bg-brand-primary/10'\r\n                                        : 'border-brand-border text-brand-muted hover:border-brand-muted'\r\n                                    }\r\n                `}\r\n                            >\r\n                                {speed}x\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Main Playback Controls */}\r\n                    <div className=\"flex items-center gap-6 order-1 sm:order-2\">\r\n                        <button\r\n                            onClick={() => skip(-15)}\r\n                            className=\"text-brand-muted hover:text-white transition-colors\"\r\n                            title=\"Reverse 15s\"\r\n                        >\r\n                            <SkipBack className=\"w-5 h-5\" />\r\n                        </button>\r\n                        <button\r\n                            onClick={togglePlay}\r\n                            className=\"w-14 h-14 rounded-full bg-brand-primary text-white flex items-center justify-center hover:scale-105 transition-transform shadow-[0_4px_20px_rgba(108,99,255,0.4)]\"\r\n                        >\r\n                            {isPlaying ? <Pause className=\"w-6 h-6 fill-current\" /> : <Play className=\"w-6 h-6 fill-current ml-1\" />}\r\n                        </button>\r\n                        <button\r\n                            onClick={() => skip(15)}\r\n                            className=\"text-brand-muted hover:text-white transition-colors\"\r\n                            title=\"Skip 15s\"\r\n                        >\r\n                            <SkipForward className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Volume & Loop */}\r\n                    <div className=\"flex items-center gap-4 order-3 sm:order-3 min-w-[120px]\">\r\n                        <button onClick={toggleMute} className=\"text-brand-muted hover:text-white transition-colors w-5\">\r\n                            {isMuted || volume === 0 ? <VolumeX className=\"w-4 h-4\" /> : <Volume2 className=\"w-4 h-4\" />}\r\n                        </button>\r\n                        <input\r\n                            type=\"range\"\r\n                            min=\"0\"\r\n                            max=\"1\"\r\n                            step=\"0.01\"\r\n                            value={isMuted ? 0 : volume}\r\n                            onChange={handleVolumeChange}\r\n                            className=\"w-16 h-1 bg-brand-border rounded appearance-none cursor-pointer accent-brand-muted\"\r\n                        />\r\n                        <button\r\n                            onClick={() => setIsLooping(!isLooping)}\r\n                            className={`transition-colors ${isLooping ? 'text-brand-primary' : 'text-brand-muted hover:text-white'}`}\r\n                        >\r\n                            <Repeat className=\"w-4 h-4\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\ChapterPill.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\DialogueCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\Navbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\PaperSearch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\SignInModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\StepIndicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\TransformationCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\TransformationModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\UploadZone.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\UploadZone.tsx:20:13\n  18 |     useEffect(() => {\n  19 |         if (importedFile) {\n> 20 |             setFile(importedFile);\n     |             ^^^^^^^ Avoid calling setState() directly within an effect\n  21 |             setError(null);\n  22 |         }\n  23 |     }, [importedFile]);","line":20,"column":13,"nodeType":null,"endLine":20,"endColumn":20},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `validateAndSetFile`, but the source dependencies were [onUpload]. Inferred different dependency than source.\n\nC:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\components\\UploadZone.tsx:54:36\n  52 |     };\n  53 |\n> 54 |     const handleDrop = useCallback((e: React.DragEvent) => {\n     |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 55 |         e.preventDefault();\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 56 |         setIsDragging(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 57 |\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 58 |         if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 59 |             validateAndSetFile(e.dataTransfer.files[0]);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 60 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 61 |     }, [onUpload]);\n     | ^^^^^^ Could not preserve existing manual memoization\n  62 |\n  63 |     const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\n  64 |         if (e.target.files && e.target.files.length > 0) {","line":54,"column":36,"nodeType":null,"endLine":61,"endColumn":6},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'validateAndSetFile'. Either include it or remove the dependency array.","line":61,"column":8,"nodeType":"ArrayExpression","endLine":61,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [validateAndSetFile]","fix":{"range":[1971,1981],"text":"[validateAndSetFile]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useEffect } from 'react';\r\nimport { UploadCloud, File, X, AlertCircle } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface UploadZoneProps {\r\n    label: string;\r\n    onUpload: (file: File | null) => void;\r\n    isDebateMode?: boolean;\r\n    importedFile?: File | null;\r\n}\r\n\r\nexport function UploadZone({ label, onUpload, isDebateMode = false, importedFile }: UploadZoneProps) {\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [file, setFile] = useState<File | null>(null);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    // Sync externally imported file (from PaperSearch) into our local state\r\n    useEffect(() => {\r\n        if (importedFile) {\r\n            setFile(importedFile);\r\n            setError(null);\r\n        }\r\n    }, [importedFile]);\r\n\r\n    const handleDragOver = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        setIsDragging(true);\r\n    }, []);\r\n\r\n    const handleDragLeave = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n    }, []);\r\n\r\n    const validateAndSetFile = (selectedFile: File) => {\r\n        if (selectedFile.type !== 'application/pdf') {\r\n            setError('Please upload a valid PDF file');\r\n            setFile(null);\r\n            onUpload(null);\r\n            return;\r\n        }\r\n        if (selectedFile.size > 50 * 1024 * 1024) {\r\n            setError('File exceeds 50MB limit');\r\n            setFile(null);\r\n            onUpload(null);\r\n            return;\r\n        }\r\n\r\n        setError(null);\r\n        setFile(selectedFile);\r\n        onUpload(selectedFile);\r\n    };\r\n\r\n    const handleDrop = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n\r\n        if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\r\n            validateAndSetFile(e.dataTransfer.files[0]);\r\n        }\r\n    }, [onUpload]);\r\n\r\n    const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files && e.target.files.length > 0) {\r\n            validateAndSetFile(e.target.files[0]);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"w-full\">\r\n            <div className=\"text-xs font-bold text-brand-muted tracking-widest mb-3 uppercase\">\r\n                {label}\r\n            </div>\r\n\r\n            <div\r\n                onDragOver={handleDragOver}\r\n                onDragLeave={handleDragLeave}\r\n                onDrop={handleDrop}\r\n                className={`相対 overflow-hidden rounded-2xl border-2 border-dashed transition-all duration-300\r\n          ${isDragging\r\n                        ? (isDebateMode ? 'border-brand-secondary bg-brand-secondary/5' : 'border-brand-primary bg-brand-primary/5')\r\n                        : 'border-brand-border bg-brand-card hover:border-brand-muted'\r\n                    }\r\n          ${file ? '!border-solid !border-brand-border' : ''}\r\n        `}\r\n            >\r\n                {!file ? (\r\n                    <div className=\"p-10 flex flex-col items-center justify-center text-center\">\r\n                        <div className={`w-16 h-16 rounded-full flex items-center justify-center mb-6 transition-colors ${isDragging\r\n                            ? (isDebateMode ? 'bg-brand-secondary/20 text-brand-secondary' : 'bg-brand-primary/20 text-brand-primary')\r\n                            : 'bg-brand-bg text-brand-muted'\r\n                            }`}>\r\n                            <UploadCloud className=\"w-8 h-8\" />\r\n                        </div>\r\n\r\n                        <h3 className=\"font-display font-medium text-lg text-brand-text mb-2\">\r\n                            Drop your PDF here\r\n                        </h3>\r\n                        <p className=\"text-brand-muted mb-6\">\r\n                            or <label className=\"text-brand-primary hover:underline cursor-pointer\">\r\n                                click to browse\r\n                                <input\r\n                                    type=\"file\"\r\n                                    className=\"hidden\"\r\n                                    accept=\"application/pdf\"\r\n                                    onChange={handleFileInput}\r\n                                />\r\n                            </label>\r\n                        </p>\r\n                        <div className=\"text-xs text-brand-muted font-mono bg-brand-bg px-3 py-1.5 rounded-full\">\r\n                            PDF only · Max 50MB\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"p-8 flex items-center gap-4 bg-brand-card\">\r\n                        <div className=\"w-12 h-12 rounded-xl bg-green-500/20 text-green-400 flex items-center justify-center flex-shrink-0\">\r\n                            <File className=\"w-6 h-6\" />\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <h4 className=\"font-medium text-brand-text truncate\">{file.name}</h4>\r\n                            <p className=\"text-sm text-brand-muted\">{(file.size / (1024 * 1024)).toFixed(2)} MB</p>\r\n                        </div>\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); setFile(null); onUpload(null); setError(null); }}\r\n                            className=\"p-2 text-brand-muted hover:text-red-400 hover:bg-red-400/10 rounded-full transition-colors\"\r\n                        >\r\n                            <X className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                <AnimatePresence>\r\n                    {error && (\r\n                        <motion.div\r\n                            initial={{ opacity: 0, y: 10 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            exit={{ opacity: 0, y: 10 }}\r\n                            className=\"absolute bottom-0 left-0 right-0 bg-red-500/90 backdrop-blur-sm text-white px-4 py-3 flex items-center justify-between text-sm z-20\"\r\n                        >\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <AlertCircle className=\"w-4 h-4 flex-shrink-0\" />\r\n                                <span>{error}</span>\r\n                            </div>\r\n                            <button onClick={e => { e.stopPropagation(); setError(null); }} className=\"p-1 hover:bg-white/20 rounded transition-colors\">\r\n                                <X className=\"w-4 h-4\" />\r\n                            </button>\r\n                        </motion.div>\r\n                    )}\r\n                </AnimatePresence>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\context\\AppContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":126,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":126,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState } from 'react';\r\nimport type { ReactNode } from 'react';\r\nimport type { Dialogue } from '../components/DialogueCard';\r\nimport { DEFAULT_TRANSFORMATIONS } from '../data/transformations';\r\nimport type { Transformation } from '../data/transformations';\r\n\r\ninterface AppState {\r\n    sessionId: string | null;\r\n    pdfTextPreview: string | null;\r\n    config: {\r\n        audience: string;\r\n        length: string;\r\n        focusAreas: string;\r\n        style: string;\r\n        introWrapup: boolean;\r\n    };\r\n    script: {\r\n        title: string;\r\n        totalWords: number;\r\n        estimatedDuration: string;\r\n        chapters: {\r\n            id: string;\r\n            title: string;\r\n            dialogues: Dialogue[];\r\n        }[];\r\n    } | null;\r\n    audioUrl: string | null;\r\n    selectedTransformation: Transformation;\r\n    customTransformations: Transformation[];\r\n    sourcePapers: { title: string; id?: string; url?: string }[];\r\n}\r\n\r\ninterface AppContextType extends AppState {\r\n    setSessionId: (id: string | null) => void;\r\n    setPdfTextPreview: (text: string | null) => void;\r\n    setConfig: (config: AppState['config']) => void;\r\n    setScript: (script: AppState['script']) => void;\r\n    setAudioUrl: (url: string | null) => void;\r\n    updateConfigField: <K extends keyof AppState['config']>(field: K, value: AppState['config'][K]) => void;\r\n    setSelectedTransformation: (t: Transformation) => void;\r\n    addCustomTransformation: (t: Transformation) => void;\r\n    updateCustomTransformation: (name: string, t: Transformation) => void;\r\n    deleteCustomTransformation: (name: string) => void;\r\n    allTransformations: Transformation[];\r\n    setSourcePapers: (papers: AppState['sourcePapers'] | ((prev: AppState['sourcePapers']) => AppState['sourcePapers'])) => void;\r\n}\r\n\r\nconst defaultState: AppState = {\r\n    sessionId: null,\r\n    pdfTextPreview: null,\r\n    config: {\r\n        audience: 'student',\r\n        length: 'medium',\r\n        focusAreas: '',\r\n        style: 'explain',\r\n        introWrapup: true\r\n    },\r\n    script: null,\r\n    audioUrl: null,\r\n    selectedTransformation: DEFAULT_TRANSFORMATIONS[0],\r\n    customTransformations: [],\r\n    sourcePapers: [],\r\n};\r\n\r\nconst AppContext = createContext<AppContextType | undefined>(undefined);\r\n\r\nexport function AppProvider({ children }: { children: ReactNode }) {\r\n    const [sessionId, setSessionId] = useState<string | null>(defaultState.sessionId);\r\n    const [pdfTextPreview, setPdfTextPreview] = useState<string | null>(defaultState.pdfTextPreview);\r\n    const [config, setConfig] = useState<AppState['config']>(defaultState.config);\r\n    const [script, setScript] = useState<AppState['script']>(defaultState.script);\r\n    const [audioUrl, setAudioUrl] = useState<string | null>(defaultState.audioUrl);\r\n    const [selectedTransformation, setSelectedTransformation] = useState<Transformation>(DEFAULT_TRANSFORMATIONS[0]);\r\n    const [customTransformations, setCustomTransformations] = useState<Transformation[]>([]);\r\n    const [sourcePapers, setSourcePapers] = useState<AppState['sourcePapers']>(defaultState.sourcePapers);\r\n\r\n    const allTransformations = [...DEFAULT_TRANSFORMATIONS, ...customTransformations];\r\n\r\n    const updateConfigField = <K extends keyof AppState['config']>(field: K, value: AppState['config'][K]) => {\r\n        setConfig(prev => ({ ...prev, [field]: value }));\r\n    };\r\n\r\n    const addCustomTransformation = (t: Transformation) => {\r\n        setCustomTransformations(prev => [...prev, { ...t, isDefault: false }]);\r\n    };\r\n\r\n    const updateCustomTransformation = (name: string, t: Transformation) => {\r\n        // For defaults, we store modified versions in custom overrides\r\n        const isDefault = DEFAULT_TRANSFORMATIONS.some(d => d.name === name);\r\n        if (isDefault) {\r\n            // Store as an override; filter old override first\r\n            setCustomTransformations(prev => [\r\n                ...prev.filter(c => c.name !== name),\r\n                { ...t, isDefault: false }\r\n            ]);\r\n        } else {\r\n            setCustomTransformations(prev => prev.map(c => c.name === name ? { ...t, isDefault: false } : c));\r\n        }\r\n        // If editing the currently selected one, update selection\r\n        if (selectedTransformation.name === name) {\r\n            setSelectedTransformation(t);\r\n        }\r\n    };\r\n\r\n    const deleteCustomTransformation = (name: string) => {\r\n        setCustomTransformations(prev => prev.filter(c => c.name !== name));\r\n        if (selectedTransformation.name === name) {\r\n            setSelectedTransformation(DEFAULT_TRANSFORMATIONS[0]);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AppContext.Provider value={{\r\n            sessionId, pdfTextPreview, config, script, audioUrl,\r\n            selectedTransformation, customTransformations, allTransformations,\r\n            setSessionId, setPdfTextPreview, setConfig, setScript, setAudioUrl,\r\n            updateConfigField, setSelectedTransformation, addCustomTransformation,\r\n            updateCustomTransformation, deleteCustomTransformation,\r\n            sourcePapers, setSourcePapers\r\n        }}>\r\n            {children}\r\n        </AppContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useAppContext() {\r\n    const context = useContext(AppContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAppContext must be used within an AppProvider');\r\n    }\r\n    return context;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\context\\AuthContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":65,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":65,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useEffect, useState } from 'react';\r\nimport type { ReactNode } from 'react';\r\nimport type { User, Session } from '@supabase/supabase-js';\r\nimport { supabase } from '../lib/supabaseClient';\r\n\r\ninterface AuthContextType {\r\n    user: User | null;\r\n    session: Session | null;\r\n    loading: boolean;\r\n    signInWithGoogle: () => Promise<void>;\r\n    signInWithMagicLink: (email: string) => Promise<{ error: string | null }>;\r\n    signOut: () => Promise<void>;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [session, setSession] = useState<Session | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        // Get current session on mount\r\n        supabase.auth.getSession().then(({ data: { session } }) => {\r\n            setSession(session);\r\n            setUser(session?.user ?? null);\r\n            setLoading(false);\r\n        });\r\n\r\n        // Listen to auth state changes\r\n        const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\r\n            setSession(session);\r\n            setUser(session?.user ?? null);\r\n        });\r\n\r\n        return () => subscription.unsubscribe();\r\n    }, []);\r\n\r\n    const signInWithGoogle = async () => {\r\n        await supabase.auth.signInWithOAuth({\r\n            provider: 'google',\r\n            options: { redirectTo: window.location.origin },\r\n        });\r\n    };\r\n\r\n    const signInWithMagicLink = async (email: string) => {\r\n        const { error } = await supabase.auth.signInWithOtp({\r\n            email,\r\n            options: { emailRedirectTo: window.location.origin },\r\n        });\r\n        return { error: error?.message ?? null };\r\n    };\r\n\r\n    const signOut = async () => {\r\n        await supabase.auth.signOut();\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, session, loading, signInWithGoogle, signInWithMagicLink, signOut }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useAuth() {\r\n    const ctx = useContext(AuthContext);\r\n    if (!ctx) throw new Error('useAuth must be used within AuthProvider');\r\n    return ctx;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\context\\ReferencesContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":74,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":74,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState } from 'react';\r\nimport type { ReactNode } from 'react';\r\n\r\nexport interface Reference {\r\n    id: string;\r\n    title: string;\r\n    authors: { name: string }[];\r\n    year: number | null;\r\n    arxivUrl: string;\r\n    pdfUrl: string | null;\r\n    source: string;\r\n    addedAt: string;\r\n    usedAs: 'primary' | 'secondary' | 'debate';\r\n}\r\n\r\ninterface ReferencesContextType {\r\n    references: Reference[];\r\n    addReference: (paper: {\r\n        id?: string;\r\n        arxivId?: string;\r\n        title: string;\r\n        authors?: { name: string }[];\r\n        year?: number | null;\r\n        arxivUrl?: string;\r\n        pdfUrl?: string | null;\r\n        source?: string;\r\n        usedAs: 'primary' | 'secondary' | 'debate';\r\n    }) => void;\r\n}\r\n\r\nconst ReferencesContext = createContext<ReferencesContextType | null>(null);\r\n\r\nexport function ReferencesProvider({ children }: { children: ReactNode }) {\r\n    const [references, setReferences] = useState<Reference[]>([]);\r\n\r\n    const addReference = (paper: {\r\n        id?: string;\r\n        arxivId?: string;\r\n        title: string;\r\n        authors?: { name: string }[];\r\n        year?: number | null;\r\n        arxivUrl?: string;\r\n        pdfUrl?: string | null;\r\n        source?: string;\r\n        usedAs: 'primary' | 'secondary' | 'debate';\r\n    }) => {\r\n        const paperId = paper.id || paper.arxivId;\r\n        if (!paperId) return;\r\n\r\n        setReferences(prev => {\r\n            const exists = prev.find(p => p.id === paperId);\r\n            if (exists) return prev;\r\n            return [...prev, {\r\n                id: paperId,\r\n                title: paper.title,\r\n                authors: paper.authors || [],\r\n                year: paper.year ?? null,\r\n                arxivUrl: paper.arxivUrl || `https://arxiv.org/abs/${paperId}`,\r\n                pdfUrl: paper.pdfUrl || null,\r\n                source: paper.source || 'arxiv',\r\n                addedAt: new Date().toISOString(),\r\n                usedAs: paper.usedAs,\r\n            }];\r\n        });\r\n    };\r\n\r\n    return (\r\n        <ReferencesContext.Provider value={{ references, addReference }}>\r\n            {children}\r\n        </ReferencesContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useReferences() {\r\n    const context = useContext(ReferencesContext);\r\n    if (!context) {\r\n        throw new Error('useReferences must be used within a ReferencesProvider');\r\n    }\r\n    return context;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\context\\ThemeContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":33,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":33,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useEffect, useState } from 'react';\r\nimport type { ReactNode } from 'react';\r\n\r\ntype Theme = 'dark' | 'light';\r\n\r\ninterface ThemeContextType {\r\n    theme: Theme;\r\n    toggleTheme: () => void;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport function ThemeProvider({ children }: { children: ReactNode }) {\r\n    const [theme, setTheme] = useState<Theme>(() => {\r\n        const stored = localStorage.getItem('papercast-theme');\r\n        return (stored === 'light' || stored === 'dark') ? stored : 'dark';\r\n    });\r\n\r\n    useEffect(() => {\r\n        document.documentElement.setAttribute('data-theme', theme);\r\n        localStorage.setItem('papercast-theme', theme);\r\n    }, [theme]);\r\n\r\n    const toggleTheme = () => setTheme(prev => (prev === 'dark' ? 'light' : 'dark'));\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ theme, toggleTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useTheme() {\r\n    const ctx = useContext(ThemeContext);\r\n    if (!ctx) throw new Error('useTheme must be used within ThemeProvider');\r\n    return ctx;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\data\\transformations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\lib\\supabaseClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\pages\\Configure.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\pages\\DebateScore.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\pages\\Home.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\pages\\Listen.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":108,"column":5,"nodeType":"Identifier","endLine":108,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'allDialogues'. Either include it or remove the dependency array.","line":121,"column":8,"nodeType":"ArrayExpression","endLine":121,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [allDialogues, currentTime]","fix":{"range":[4942,4955],"text":"[allDialogues, currentTime]"}}]},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":124,"column":5,"nodeType":"Identifier","endLine":124,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":247,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":247,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11968,11971],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11968,11971],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Download, Share2, Copy, Check, Link as LinkIcon, ExternalLink, BookOpen } from 'lucide-react';\r\nimport { AudioPlayer } from '../components/AudioPlayer';\r\nimport { ChapterPill } from '../components/ChapterPill';\r\nimport { StepIndicator } from '../components/StepIndicator';\r\nimport { useAppContext } from '../context/AppContext';\r\nimport { useReferences } from '../context/ReferencesContext';\r\n\r\n// Parse \"HH:MM:SS\" or \"MM:SS\" timestamp strings into total seconds\r\nfunction parseTimestamp(ts: string): number {\r\n    if (!ts) return 0;\r\n    const parts = ts.split(':').map(Number);\r\n    if (parts.length === 3) return parts[0] * 3600 + parts[1] * 60 + parts[2];\r\n    if (parts.length === 2) return parts[0] * 60 + parts[1];\r\n    return 0;\r\n}\r\n\r\n// Convert absolute seconds back to MM:SS or HH:MM:SS\r\nfunction formatTimestamp(totalSeconds: number): string {\r\n    const h = Math.floor(totalSeconds / 3600);\r\n    const m = Math.floor((totalSeconds % 3600) / 60);\r\n    const s = Math.floor(totalSeconds % 60);\r\n    if (h > 0) {\r\n        return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n    }\r\n    return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n}\r\n\r\n\r\n\r\nexport function Listen() {\r\n    const navigate = useNavigate();\r\n    const { script, audioUrl, sourcePapers } = useAppContext();\r\n    const { references } = useReferences();\r\n\r\n    const [activeDialogue, setActiveDialogue] = useState(-1);\r\n    const [activeChapter, setActiveChapter] = useState(0);\r\n    const [autoScroll, setAutoScroll] = useState(true);\r\n    const [currentTime, setCurrentTime] = useState(0);\r\n    const [copied, setCopied] = useState(false);\r\n    const [shared, setShared] = useState(false);\r\n    const transcriptRef = useRef<HTMLDivElement>(null);\r\n    const audioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n    const handleShare = async () => {\r\n        const shareData = {\r\n            title: script?.title ?? 'PaperCast Episode',\r\n            text: `🎙️ Listen to \"${script?.title}\" — generated by PaperCast`,\r\n            url: window.location.href,\r\n        };\r\n        if (navigator.share && navigator.canShare(shareData)) {\r\n            try { await navigator.share(shareData); } catch { /* user cancelled */ }\r\n        } else {\r\n            // Fallback: copy the URL to clipboard\r\n            await navigator.clipboard.writeText(window.location.href);\r\n            setShared(true);\r\n            setTimeout(() => setShared(false), 2000);\r\n        }\r\n    };\r\n\r\n    const handleCopyTranscript = async () => {\r\n        if (!script) return;\r\n        const lines = script.chapters.flatMap(ch => [\r\n            `\\n── ${ch.title} ──`,\r\n            ...ch.dialogues.map(d => `[${d.timestamp}] ${d.speaker.toUpperCase()}: ${d.text}`)\r\n        ]);\r\n        const text = `${script.title}\\n${'─'.repeat(60)}\\n${lines.join('\\n')}`;\r\n        await navigator.clipboard.writeText(text);\r\n        setCopied(true);\r\n        setTimeout(() => setCopied(false), 2000);\r\n    };\r\n\r\n    if (!script || !audioUrl) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center flex-col gap-4 text-brand-muted\">\r\n                <h2 className=\"text-xl\">No audio available.</h2>\r\n                <button onClick={() => navigate('/edit')} className=\"text-brand-primary hover:underline\">Go back to Editor</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Flatten dialogues for transcript with cumulative seconds\r\n    const rawDialogues = script.chapters.flatMap((c, cIdx) =>\r\n        c.dialogues.map((d) => ({\r\n            ...d,\r\n            chapterIndex: cIdx,\r\n            isAlex: d.speaker.toLowerCase() === 'alex',\r\n            startSeconds: parseTimestamp(d.timestamp)\r\n        }))\r\n    );\r\n\r\n    const allDialogues: (typeof rawDialogues[0] & { isContinuation?: boolean })[] = [];\r\n\r\n    for (let i = 0; i < rawDialogues.length; i++) {\r\n        const current = rawDialogues[i];\r\n        // We removed text chunking here to prevent any accidental drops of text \r\n        // that lack standard punctuation. We now render exact AI dialogues.\r\n        allDialogues.push({\r\n            ...current,\r\n            startSeconds: current.startSeconds,\r\n            timestamp: formatTimestamp(current.startSeconds),\r\n            isContinuation: false\r\n        });\r\n    }\r\n\r\n    // Sync active dialogue based on current playback time\r\n    useEffect(() => {\r\n        let activeIdx = -1;\r\n        for (let i = 0; i < allDialogues.length; i++) {\r\n            if (currentTime >= allDialogues[i].startSeconds) {\r\n                activeIdx = i;\r\n            }\r\n        }\r\n        setActiveDialogue(activeIdx);\r\n\r\n        // Update active chapter\r\n        if (activeIdx >= 0) {\r\n            setActiveChapter(allDialogues[activeIdx].chapterIndex);\r\n        }\r\n    }, [currentTime]);\r\n\r\n    // Auto-scroll active dialogue into view\r\n    useEffect(() => {\r\n        if (!autoScroll || !transcriptRef.current) return;\r\n        const active = transcriptRef.current.querySelector('[data-active=\"true\"]');\r\n        if (active) {\r\n            active.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n        }\r\n    }, [activeDialogue, autoScroll]);\r\n\r\n    // Seek audio to a specific dialogue when transcript is clicked\r\n    const handleTranscriptClick = (dialogue: typeof allDialogues[0]) => {\r\n        if (audioRef.current) {\r\n            audioRef.current.currentTime = dialogue.startSeconds;\r\n            // If paused, start playing\r\n            audioRef.current.play().catch(() => { });\r\n            setCurrentTime(dialogue.startSeconds);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen pt-24 pb-32 px-4 sm:px-6 lg:px-8 max-w-5xl mx-auto\">\r\n            <StepIndicator currentStep={5} />\r\n\r\n            <div className=\"text-center mb-10\">\r\n                <h1 className=\"text-3xl md:text-4xl font-display font-bold mb-3\">{script.title}</h1>\r\n                <p className=\"text-brand-muted text-lg font-mono mb-4\">Total Duration: {script.estimatedDuration}</p>\r\n\r\n                {sourcePapers && sourcePapers.length > 0 && (\r\n                    <div className=\"flex flex-wrap items-center justify-center gap-2 mt-4\">\r\n                        <div className=\"flex items-center gap-2 text-xs font-bold text-brand-muted uppercase tracking-widest mr-2\">\r\n                            <LinkIcon className=\"w-3.5 h-3.5\" /> Sources\r\n                        </div>\r\n                        {sourcePapers.map((paper, i) => (\r\n                            paper.url ? (\r\n                                <a\r\n                                    key={i}\r\n                                    href={paper.url}\r\n                                    target=\"_blank\"\r\n                                    rel=\"noopener noreferrer\"\r\n                                    className=\"inline-flex items-center gap-1.5 text-xs font-medium px-2.5 py-1 rounded-md bg-brand-secondary/10 text-brand-secondary border border-brand-secondary/20 hover:bg-brand-secondary/20 transition-colors\"\r\n                                >\r\n                                    {paper.id ? `arXiv:${paper.id}` : (paper.title || `Paper ${i + 1}`)}\r\n                                    <ExternalLink className=\"w-3 h-3\" />\r\n                                </a>\r\n                            ) : (\r\n                                <span key={i} className=\"inline-flex items-center gap-1.5 text-xs font-medium px-2.5 py-1 rounded-md bg-brand-muted/10 text-brand-muted border border-brand-border\">\r\n                                    {paper.title || `Uploaded Paper ${i + 1}`}\r\n                                </span>\r\n                            )\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"mb-12\">\r\n                <AudioPlayer\r\n                    audioUrl={audioUrl}\r\n                    title={script.title}\r\n                    duration={script.estimatedDuration}\r\n                    audioRef={audioRef}\r\n                    onTimeUpdate={(t) => setCurrentTime(t)}\r\n                />\r\n            </div>\r\n\r\n            <div className=\"mb-8\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    <h2 className=\"text-xs font-bold text-brand-muted tracking-widest uppercase\">Chapters</h2>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-xs text-brand-muted mr-2\">Auto-scroll</span>\r\n                        <button\r\n                            onClick={() => setAutoScroll(!autoScroll)}\r\n                            className={`w-10 h-5 rounded-full p-1 transition-colors ${autoScroll ? 'bg-brand-primary' : 'bg-brand-border'}`}\r\n                        >\r\n                            <div className={`w-3 h-3 rounded-full bg-white transition-transform ${autoScroll ? 'translate-x-5' : 'translate-x-0'}`} />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex overflow-x-auto pb-4 gap-3 no-scrollbar mask-edges\">\r\n                    {script.chapters.map((chapter, i) => (\r\n                        <ChapterPill\r\n                            key={i}\r\n                            title={chapter.title}\r\n                            timestamp={chapter.dialogues[0]?.timestamp || \"00:00\"}\r\n                            isActive={activeChapter === i}\r\n                            onClick={() => {\r\n                                setActiveChapter(i);\r\n                                // Jump audio to first dialogue of this chapter\r\n                                const firstDialogue = allDialogues.find(d => d.chapterIndex === i);\r\n                                if (firstDialogue) handleTranscriptClick(firstDialogue);\r\n                            }}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Live Transcript Feature */}\r\n            <div className=\"bg-brand-card/50 border border-brand-border rounded-3xl p-6 sm:p-10 relative overflow-hidden\">\r\n                <div className=\"absolute top-0 left-0 right-0 h-16 bg-gradient-to-b from-brand-card/50 to-transparent z-10 pointer-events-none\" />\r\n\r\n                <div\r\n                    ref={transcriptRef}\r\n                    className=\"space-y-8 relative z-0 h-[500px] overflow-y-auto pr-4 custom-scrollbar\"\r\n                >\r\n                    {allDialogues.map((dialogue, idx) => {\r\n                        const state = idx === activeDialogue ? 'active' : idx < activeDialogue ? 'past' : 'future';\r\n\r\n                        return (\r\n                            <div\r\n                                key={idx}\r\n                                data-active={state === 'active'}\r\n                                onClick={() => handleTranscriptClick(dialogue)}\r\n                                title=\"Click to jump to this part\"\r\n                                className={`flex items-start gap-4 transition-all duration-500 cursor-pointer group\r\n                   ${state === 'active'\r\n                                        ? 'opacity-100 scale-100 filter drop-shadow-[0_0_15px_rgba(255,255,255,0.1)]'\r\n                                        : state === 'past'\r\n                                            ? 'opacity-40 scale-95 grayscale hover:opacity-70 hover:grayscale-0'\r\n                                            : 'opacity-60 scale-95 hover:opacity-80'\r\n                                    }\r\n                   ${!dialogue.isAlex ? 'flex-row-reverse text-right' : ''}\r\n                 `}\r\n                            >\r\n                                <div className={`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 font-bold border-2 transition-all\r\n                   ${(dialogue as any).isContinuation ? 'opacity-0' : ''}\r\n                   ${dialogue.isAlex\r\n                                        ? state === 'active' ? 'bg-brand-primary text-white border-brand-primary' : 'bg-brand-accent-alex text-brand-primary border-brand-border group-hover:border-brand-primary'\r\n                                        : state === 'active' ? 'bg-brand-secondary text-brand-bg border-brand-secondary' : 'bg-brand-accent-sam text-brand-secondary border-brand-border group-hover:border-brand-secondary'\r\n                                    }\r\n                 `}>\r\n                                    {dialogue.isAlex ? 'A' : 'S'}\r\n                                </div>\r\n\r\n                                <div className={`flex-1 rounded-xl transition-all duration-300 ${state === 'active' ? 'bg-white/5 border border-white/10 p-4' : 'p-2 group-hover:bg-white/3'}`}>\r\n                                    <div className=\"flex items-center gap-2 mb-1.5\">\r\n                                        <span className=\"font-mono text-xs text-brand-muted\">{dialogue.timestamp}</span>\r\n                                        {state !== 'active' && (\r\n                                            <span className=\"opacity-0 group-hover:opacity-100 transition-opacity text-[10px] text-brand-muted/70 font-mono\">\r\n                                                ▶ click to jump\r\n                                            </span>\r\n                                        )}\r\n                                    </div>\r\n                                    <p className={`text-lg leading-relaxed ${state === 'active' ? 'text-white font-medium' : 'text-brand-text'}`}>\r\n                                        {dialogue.text}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                <div className=\"absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t from-brand-card/90 to-transparent z-10 pointer-events-none\" />\r\n            </div>\r\n\r\n            {/* 📚 References Section */}\r\n            <div className=\"mt-12 mb-8\">\r\n                <div className=\"mb-6\">\r\n                    <h2 className=\"text-xl font-display font-bold flex items-center gap-2\">\r\n                        <BookOpen className=\"w-5 h-5 text-brand-primary\" />\r\n                        📚 References\r\n                    </h2>\r\n                    <p className=\"text-brand-muted text-sm mt-1\">Research papers used to generate this podcast</p>\r\n                </div>\r\n\r\n                {references.length === 0 ? (\r\n                    <div className=\"bg-brand-card/50 border border-brand-border rounded-2xl p-6 text-center\">\r\n                        <p className=\"text-brand-muted text-sm\">\r\n                            This podcast was generated from a manually uploaded PDF. No arXiv references available.\r\n                        </p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"space-y-4\">\r\n                        {references.map((ref, i) => {\r\n                            const badgeStyles = {\r\n                                primary: { bg: 'bg-[#6C63FF]/15', text: 'text-[#6C63FF]', border: 'border-[#6C63FF]/30', label: 'Primary Paper', leftBorder: '#6C63FF' },\r\n                                secondary: { bg: 'bg-[#00D4AA]/15', text: 'text-[#00D4AA]', border: 'border-[#00D4AA]/30', label: 'Second Paper', leftBorder: '#00D4AA' },\r\n                                debate: { bg: 'bg-orange-500/15', text: 'text-orange-400', border: 'border-orange-500/30', label: 'Debate Paper', leftBorder: '#f97316' },\r\n                            };\r\n                            const badge = badgeStyles[ref.usedAs];\r\n\r\n                            return (\r\n                                <div key={ref.id} className=\"group\">\r\n                                    {/* Citation Card */}\r\n                                    <div\r\n                                        className=\"bg-[#12121A] border border-[#1E1E2E] rounded-2xl p-5 transition-all hover:border-brand-muted/30\"\r\n                                        style={{ borderLeftWidth: 3, borderLeftColor: badge.leftBorder }}\r\n                                    >\r\n                                        <div className=\"flex items-start justify-between gap-4\">\r\n                                            <div className=\"flex-1 min-w-0\">\r\n                                                <div className=\"flex items-center gap-2 mb-2\">\r\n                                                    <span className=\"text-brand-muted font-mono text-xs font-bold\">[{i + 1}]</span>\r\n                                                    <span className={`text-[10px] font-bold px-2 py-0.5 rounded-full ${badge.bg} ${badge.text} ${badge.border} border`}>\r\n                                                        {badge.label}\r\n                                                    </span>\r\n                                                </div>\r\n                                                <a\r\n                                                    href={ref.arxivUrl}\r\n                                                    target=\"_blank\"\r\n                                                    rel=\"noopener noreferrer\"\r\n                                                    className=\"text-white font-semibold text-sm hover:text-brand-primary transition-colors leading-snug block mb-2\"\r\n                                                >\r\n                                                    {ref.title}\r\n                                                </a>\r\n                                                {ref.authors.length > 0 && (\r\n                                                    <p className=\"text-brand-muted text-xs mb-1\">\r\n                                                        {ref.authors.map(a => a.name).join(', ')}\r\n                                                    </p>\r\n                                                )}\r\n                                                {ref.year && (\r\n                                                    <p className=\"text-brand-muted text-xs font-mono\">{ref.year}</p>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex items-center gap-2 mt-4\">\r\n                                            <a\r\n                                                href={ref.arxivUrl}\r\n                                                target=\"_blank\"\r\n                                                rel=\"noopener noreferrer\"\r\n                                                className=\"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-brand-border hover:border-brand-primary text-brand-muted hover:text-brand-primary text-xs font-medium transition-all\"\r\n                                            >\r\n                                                View on arXiv <ExternalLink className=\"w-3 h-3\" />\r\n                                            </a>\r\n                                            {ref.pdfUrl && (\r\n                                                <a\r\n                                                    href={ref.pdfUrl}\r\n                                                    target=\"_blank\"\r\n                                                    rel=\"noopener noreferrer\"\r\n                                                    className=\"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-brand-border hover:border-brand-muted text-brand-muted hover:text-brand-text text-xs font-medium transition-all\"\r\n                                                >\r\n                                                    <Download className=\"w-3 h-3\" /> Download PDF\r\n                                                </a>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Academic Citation Format */}\r\n                                    <p className=\"text-brand-muted/60 text-[11px] font-mono mt-2 pl-4\">\r\n                                        [{i + 1}] {ref.authors.length > 0 ? ref.authors.map(a => a.name).join(', ') + '. ' : ''}\r\n                                        \"{ref.title}.\" {ref.year ? `${ref.year}. ` : ''}arXiv:{ref.id}\r\n                                    </p>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Sticky Bottom Bar for Export */}\r\n            <div className=\"fixed bottom-0 left-0 right-0 bg-brand-bg/90 backdrop-blur-xl border-t border-brand-border py-4 px-6 z-50 overflow-hidden\">\r\n                <div className=\"max-w-5xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <div className=\"w-12 h-12 rounded bg-gradient-to-br from-brand-primary to-brand-secondary opacity-80 flex-shrink-0 hidden sm:block\" />\r\n                        <div className=\"min-w-0 pr-4\">\r\n                            <div className=\"text-brand-text font-bold truncate max-w-[200px] sm:max-w-md\">{script.title}</div>\r\n                            <div className=\"text-brand-muted text-xs font-mono\">{script.estimatedDuration} • {script.totalWords} words</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3 w-full sm:w-auto\">\r\n                        <button\r\n                            onClick={handleShare}\r\n                            className=\"flex-1 sm:flex-none flex items-center justify-center gap-2 px-5 py-2.5 rounded-full border border-brand-border hover:border-brand-primary text-brand-text hover:text-brand-primary bg-brand-bg hover:bg-brand-primary/10 transition-colors text-sm font-medium\"\r\n                        >\r\n                            {shared ? <Check className=\"w-4 h-4 text-brand-secondary\" /> : <Share2 className=\"w-4 h-4\" />}\r\n                            {shared ? 'Link Copied!' : 'Share'}\r\n                        </button>\r\n                        <button\r\n                            onClick={handleCopyTranscript}\r\n                            className=\"flex-1 sm:flex-none flex items-center justify-center gap-2 px-5 py-2.5 rounded-full border border-brand-border hover:border-brand-text text-brand-text bg-brand-card hover:bg-brand-card-hover transition-colors text-sm font-medium\"\r\n                        >\r\n                            {copied ? <Check className=\"w-4 h-4 text-brand-secondary\" /> : <Copy className=\"w-4 h-4\" />}\r\n                            {copied ? 'Copied!' : 'Transcript'}\r\n                        </button>\r\n                        <a\r\n                            href={audioUrl}\r\n                            download=\"PaperCast-Episode.mp3\"\r\n                            className=\"flex-1 sm:flex-none flex items-center justify-center gap-2 px-6 py-2.5 rounded-full bg-transparent border-2 border-brand-primary text-brand-primary hover:bg-brand-primary hover:text-white transition-colors text-sm font-bold shadow-[0_0_15px_rgba(108,99,255,0.2)] hover:shadow-[0_0_20px_rgba(108,99,255,0.4)] whitespace-nowrap\"\r\n                        >\r\n                            <Download className=\"w-4 h-4\" /> Save MP3\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\pages\\ScriptEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_chapterIndex' is defined but never used.","line":48,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":52},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_dialogueIndex' is defined but never used.","line":48,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":76}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Layers, RotateCcw, Headphones, ArrowLeft } from 'lucide-react';\r\nimport { StepIndicator } from '../components/StepIndicator';\r\nimport { DialogueCard } from '../components/DialogueCard';\r\nimport type { Dialogue } from '../components/DialogueCard';\r\nimport { useAppContext } from '../context/AppContext';\r\nimport { AudioLoadingScreen } from '../components/AudioLoadingScreen';\r\n\r\nexport function ScriptEditor() {\r\n    const navigate = useNavigate();\r\n    const { sessionId, script, setScript, setAudioUrl } = useAppContext();\r\n\r\n    const [activeChapter, setActiveChapter] = useState(0);\r\n    const [isGeneratingAudio, setIsGeneratingAudio] = useState(false);\r\n    const [audioJobId, setAudioJobId] = useState<string | null>(null);\r\n\r\n    const recalculateMetadata = (newScript: typeof script) => {\r\n        if (!newScript) return newScript;\r\n        let totalWords = 0;\r\n        newScript.chapters.forEach(c => {\r\n            c.dialogues.forEach(d => {\r\n                totalWords += d.text.split(/\\s+/).filter(Boolean).length;\r\n            });\r\n        });\r\n        const mins = Math.floor(totalWords / 150);\r\n        const secs = Math.floor((totalWords % 150) / 2.5);\r\n        newScript.totalWords = totalWords;\r\n        newScript.estimatedDuration = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n        return newScript;\r\n    };\r\n\r\n    if (!script) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center flex-col gap-4 text-brand-muted\">\r\n                <h2 className=\"text-xl\">No script found.</h2>\r\n                <button onClick={() => navigate('/configure')} className=\"text-brand-primary hover:underline\">Go back to Configure</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const handleUpdateDialogueUrl = (chapterIndex: number, dialogueIndex: number, newText: string) => {\r\n        const newScript = JSON.parse(JSON.stringify(script));\r\n        newScript.chapters[chapterIndex].dialogues[dialogueIndex].text = newText;\r\n        setScript(recalculateMetadata(newScript));\r\n    };\r\n\r\n    const handleRegenerateDialogue = (_chapterIndex: number, _dialogueIndex: number) => {\r\n        // In MVP, just an alert. Integration with real API to regenerate one block would go here.\r\n        alert(\"Regenerating a single block requires block-level API support.\");\r\n    };\r\n\r\n    const handleDeleteDialogue = (chapterIndex: number, dialogueIndex: number) => {\r\n        const newScript = JSON.parse(JSON.stringify(script));\r\n        newScript.chapters[chapterIndex].dialogues.splice(dialogueIndex, 1);\r\n        setScript(recalculateMetadata(newScript));\r\n    };\r\n\r\n    const handleGenerateAudio = async () => {\r\n        setIsGeneratingAudio(true);\r\n        try {\r\n            const response = await fetch('/api/audio', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    sessionId,\r\n                    script\r\n                })\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Audio generation failed');\r\n\r\n            const data = await response.json();\r\n\r\n            if (data.jobId) {\r\n                // New async flow — show loading screen\r\n                setAudioJobId(data.jobId);\r\n            } else if (data.audioUrl) {\r\n                // Fallback: old sync flow\r\n                setAudioUrl(data.audioUrl);\r\n                navigate('/listen');\r\n            }\r\n        } catch (error) {\r\n            console.error(error);\r\n            setIsGeneratingAudio(false);\r\n            alert('Failed to generate audio');\r\n        }\r\n    };\r\n\r\n    const handleAudioReady = (audioUrl: string) => {\r\n        setAudioUrl(audioUrl);\r\n        setAudioJobId(null);\r\n        setIsGeneratingAudio(false);\r\n        navigate('/listen');\r\n    };\r\n\r\n    const handleAudioError = () => {\r\n        // Retry: reset and try again\r\n        setAudioJobId(null);\r\n        setIsGeneratingAudio(false);\r\n        handleGenerateAudio();\r\n    };\r\n\r\n    const handleAudioBack = () => {\r\n        setAudioJobId(null);\r\n        setIsGeneratingAudio(false);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Audio Loading Screen Overlay */}\r\n            {audioJobId && (\r\n                <AudioLoadingScreen\r\n                    paperTitle={script.title || 'Untitled Podcast'}\r\n                    jobId={audioJobId}\r\n                    onAudioReady={handleAudioReady}\r\n                    onError={handleAudioError}\r\n                    onBack={handleAudioBack}\r\n                />\r\n            )}\r\n\r\n            <div className=\"min-h-screen pt-24 pb-32 px-4 sm:px-6 lg:px-8 max-w-5xl mx-auto\">\r\n                <StepIndicator currentStep={4} />\r\n\r\n                {/* Top Bar */}\r\n                <div className=\"flex flex-col md:flex-row items-center justify-between gap-4 mb-8 bg-brand-card border border-brand-border rounded-2xl p-4 shadow-sm sticky top-20 z-40\">\r\n                    <div className=\"flex items-center gap-3 w-full md:w-auto overflow-hidden\">\r\n                        <Layers className=\"w-5 h-5 text-brand-primary flex-shrink-0\" />\r\n                        <div className=\"text-brand-muted text-sm whitespace-nowrap hidden sm:block\">Research Paper <span className=\"mx-2\">&gt;</span></div>\r\n                        <h2 className=\"font-display font-semibold text-brand-text truncate pr-4\">{script.title || 'Untitled Podcast'}</h2>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3 w-full md:w-auto\">\r\n                        <button className=\"flex items-center gap-2 px-4 py-2 text-sm font-medium text-brand-text hover:text-brand-primary hover:bg-brand-primary/10 rounded-lg transition-colors\">\r\n                            <RotateCcw className=\"w-4 h-4\" />\r\n                            <span className=\"hidden sm:inline\">Regenerate</span>\r\n                        </button>\r\n                        <button\r\n                            onClick={handleGenerateAudio}\r\n                            disabled={isGeneratingAudio}\r\n                            className=\"flex-1 md:flex-none flex items-center justify-center gap-2 px-5 py-2 bg-gradient-to-r from-brand-primary to-[#8b84ff] hover:shadow-[0_0_15px_rgba(108,99,255,0.4)] text-white text-sm font-semibold rounded-lg transition-all\"\r\n                        >\r\n                            {isGeneratingAudio ? 'Synthesizing...' : 'Generate Audio 🎧'}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Main Content Area */}\r\n                <div className=\"flex flex-col lg:flex-row gap-8\">\r\n\r\n                    {/* Left Sidebar: Chapters & Summary */}\r\n                    <div className=\"w-full lg:w-64 flex-shrink-0 space-y-6 lg:sticky lg:top-40 h-fit\">\r\n                        <div className=\"bg-brand-card border border-brand-border rounded-2xl p-5\">\r\n                            <h3 className=\"text-xs font-bold text-brand-muted uppercase tracking-widest mb-4\">Chapters</h3>\r\n                            <div className=\"flex flex-row lg:flex-col gap-2 overflow-x-auto lg:overflow-visible pb-2 lg:pb-0\">\r\n                                {script.chapters.map((chapter, i) => (\r\n                                    <button\r\n                                        key={i}\r\n                                        onClick={() => setActiveChapter(i)}\r\n                                        className={`flex-shrink-0 lg:flex-shrink w-auto lg:w-full text-left px-4 py-2.5 rounded-xl text-sm font-medium transition-all ${activeChapter === i\r\n                                            ? 'bg-brand-primary text-white shadow-md'\r\n                                            : 'bg-brand-bg/50 text-brand-muted hover:text-brand-text hover:bg-brand-bg border border-transparent hover:border-brand-border'\r\n                                            }`}\r\n                                    >\r\n                                        {chapter.title}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"bg-brand-card/80 border border-brand-border rounded-xl p-5 hidden lg:block\">\r\n                            <h3 className=\"text-xs font-bold text-brand-muted uppercase tracking-widest mb-3\">Est. Outcome</h3>\r\n                            <div className=\"space-y-3 font-mono text-sm\">\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-brand-muted\">Words:</span>\r\n                                    <span className=\"text-brand-text\">{script.totalWords}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-brand-muted\">Duration:</span>\r\n                                    <span className=\"text-brand-text\">{script.estimatedDuration}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right Area: Dialogue Feed */}\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"text-center mb-8\">\r\n                            <div className=\"inline-flex items-center justify-center px-4 py-1.5 rounded-full border border-brand-primary/30 bg-brand-primary/10 text-brand-primary text-xs font-bold tracking-widest uppercase shadow-[0_0_10px_rgba(108,99,255,0.1)]\">\r\n                                Chapter {activeChapter + 1}: {script.chapters[activeChapter].title}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2 relative\">\r\n                            {/* Center line for conversation visual */}\r\n                            <div className=\"absolute left-1/2 top-4 bottom-4 w-px bg-gradient-to-b from-transparent via-brand-border to-transparent -translate-x-1/2 opacity-50 z-0 hidden sm:block\" />\r\n\r\n                            {script.chapters[activeChapter].dialogues.map((dialogue: Dialogue, dIndex: number) => (\r\n                                <DialogueCard\r\n                                    key={`${activeChapter}-${dIndex}`}\r\n                                    dialogue={dialogue}\r\n                                    onUpdate={(txt) => handleUpdateDialogueUrl(activeChapter, dIndex, txt)}\r\n                                    onRegenerate={() => handleRegenerateDialogue(activeChapter, dIndex)}\r\n                                    onDelete={() => handleDeleteDialogue(activeChapter, dIndex)}\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Sticky Bottom Bar */}\r\n                <div className=\"fixed bottom-0 left-0 right-0 bg-brand-bg/90 backdrop-blur-xl border-t border-brand-border p-4 z-50 shadow-[0_-10px_30px_rgba(0,0,0,0.5)]\">\r\n                    <div className=\"max-w-5xl mx-auto flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-6\">\r\n                            <button onClick={() => navigate('/configure')} className=\"hidden sm:flex items-center gap-2 text-brand-muted hover:text-white transition-colors text-sm font-medium\">\r\n                                <ArrowLeft className=\"w-4 h-4\" /> Back to Config\r\n                            </button>\r\n                            <div className=\"text-sm border-l border-brand-border pl-6 hidden md:block\">\r\n                                <span className=\"text-brand-muted\">Script Status: </span>\r\n                                <span className=\"text-green-400 font-medium flex items-center gap-1.5 inline-flex\"><span className=\"w-1.5 h-1.5 rounded-full bg-green-400\"></span> Ready to Air</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button\r\n                            onClick={handleGenerateAudio}\r\n                            disabled={isGeneratingAudio}\r\n                            className=\"w-full sm:w-auto flex items-center justify-center gap-2 px-8 py-3 bg-white text-black text-sm font-extrabold rounded-full hover:scale-105 transition-all shadow-[0_0_20px_rgba(255,255,255,0.15)]\"\r\n                        >\r\n                            {isGeneratingAudio ? (\r\n                                <>\r\n                                    <div className=\"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin\" />\r\n                                    Synthesizing Voices...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Headphones className=\"w-4 h-4\" /> Finalize Audio\r\n                                </>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\src\\pages\\Transformations.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Vivekananda Reddy\\PaperCast\\frontend\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
